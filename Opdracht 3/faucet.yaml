version: 2

include:
  - acls.yaml

vlans:
  mgmt:
    vid: 10

  office_a:
    vid: 100

  guest_a:
    vid: 200

  office_b:
    vid: 101

  guest_b:
    vid: 201

meters:
  guest-5m:
    meter_id: 200
    entry:
      flags: [KBPS, BURST, STATS]
      bands:
        - type: DROP
          rate: 5000
          burst_size: 500

dps:

  Acore:
    dp_id: 0x0000000000000004
    hardware: "Open vSwitch"
    interfaces:
      1:
        description: "trunk to Asw1"
        tagged_vlans: [mgmt, office_a, guest_a]
      2:
        description: "trunk to Asw2"
        tagged_vlans: [mgmt, office_a, guest_a]
      3:
        description: "trunk to Asw3"
        tagged_vlans: [mgmt, office_a, guest_a]

      5:
        description: "core-to-core trunk to Bcore"
        tagged_vlans: [mgmt]

      6:
        description: "Anat guest_a gateway"
        native_vlan: guest_a
        acl_in: guest_a_nat_acl

      7:
        description: "Anat office_a gateway"
        native_vlan: office_a
        acl_in: office_acl

      10:
        description: "Acore_mgmt host"
        native_vlan: mgmt
        acl_in: mgmt_acl

  Bcore:
    dp_id: 0x0000000000000008
    hardware: "Open vSwitch"
    interfaces:
      1:
        description: "trunk to Bsw1"
        tagged_vlans: [mgmt, office_b, guest_b]
      2:
        description: "trunk to Bsw2"
        tagged_vlans: [mgmt, office_b, guest_b]
      3:
        description: "trunk to Bsw3"
        tagged_vlans: [mgmt, office_b, guest_b]

      5:
        description: "core-to-core trunk to Acore"
        tagged_vlans: [mgmt]

      6:
        description: "Bnat guest_b gateway"
        native_vlan: guest_b
        acl_in: guest_b_nat_acl

      7:
        description: "Bnat office_b gateway"
        native_vlan: office_b
        acl_in: office_acl

      10:
        description: "Bcore_mgmt host"
        native_vlan: mgmt
        acl_in: mgmt_acl

  Asw1:
    dp_id: 0x0000000000000001
    hardware: "Open vSwitch"
    interfaces:
      1:
        description: "Af1h1 office A PC"
        native_vlan: office_a
        acl_in: office_acl
      2:
        description: "Af1h2 office A PC"
        native_vlan: office_a
        acl_in: office_acl

      3:
        description: "Af1g1 guest A PC"
        native_vlan: guest_a
        acl_in: guest_a_acl

      4:
        description: "Asvc1 mgmt A"
        native_vlan: mgmt
        acl_in: mgmt_acl

      6:
        description: "Af1g2 guest A PC"
        native_vlan: guest_a
        acl_in: guest_a_acl

      7:
        description: "uplink to Acore"
        tagged_vlans: [mgmt, office_a, guest_a]

  Asw2:
    dp_id: 0x0000000000000002
    hardware: "Open vSwitch"
    interfaces:
      1:
        description: "Af2h1 office A PC"
        native_vlan: office_a
        acl_in: office_acl
      2:
        description: "Af2h2 office A PC"
        native_vlan: office_a
        acl_in: office_acl
      3:
        description: "Af2g1 guest A PC"
        native_vlan: guest_a
        acl_in: guest_a_acl
      4:
        description: "Asvc2 mgmt A"
        native_vlan: mgmt
        acl_in: mgmt_acl
      6:
        description: "Af2g2 guest A PC"
        native_vlan: guest_a
        acl_in: guest_a_acl
      23:
        description: "uplink to Acore"
        tagged_vlans: [mgmt, office_a, guest_a]

  Asw3:
    dp_id: 0x0000000000000003
    hardware: "Open vSwitch"
    interfaces:
      1:
        description: "Af3h1 office A PC"
        native_vlan: office_a
        acl_in: office_acl
      2:
        description: "Af3h2 office A PC"
        native_vlan: office_a
        acl_in: office_acl
      3:
        description: "Af3g1 guest A PC"
        native_vlan: guest_a
        acl_in: guest_a_acl
      4:
        description: "Asvc3 mgmt A"
        native_vlan: mgmt
        acl_in: mgmt_acl
      6:
        description: "Af3g2 guest A PC"
        native_vlan: guest_a
        acl_in: guest_a_acl
      24:
        description: "uplink to Acore"
        tagged_vlans: [mgmt, office_a, guest_a]

  Bsw1:
    dp_id: 0x0000000000000005
    hardware: "Open vSwitch"
    interfaces:
      1:
        description: "Bf1h1 office B PC"
        native_vlan: office_b
        acl_in: office_acl
      2:
        description: "Bf1h2 office B PC"
        native_vlan: office_b
        acl_in: office_acl

      3:
        description: "Bf1g1 guest B PC"
        native_vlan: guest_b
        acl_in: guest_b_acl

      4:
        description: "Bsvc1 mgmt B"
        native_vlan: mgmt
        acl_in: mgmt_acl

      6:
        description: "Bf1g2 guest B PC"
        native_vlan: guest_b
        acl_in: guest_b_acl

      7:
        description: "uplink to Bcore"
        tagged_vlans: [mgmt, office_b, guest_b]

  Bsw2:
    dp_id: 0x0000000000000006
    hardware: "Open vSwitch"
    interfaces:
      1:
        description: "Bf2h1 office B PC"
        native_vlan: office_b
        acl_in: office_acl
      2:
        description: "Bf2h2 office B PC"
        native_vlan: office_b
        acl_in: office_acl
      3:
        description: "Bf2g1 guest B PC"
        native_vlan: guest_b
        acl_in: guest_b_acl
      4:
        description: "Bsvc2 mgmt B"
        native_vlan: mgmt
        acl_in: mgmt_acl
      6:
        description: "Bf2g2 guest B PC"
        native_vlan: guest_b
        acl_in: guest_b_acl
      23:
        description: "uplink to Bcore"
        tagged_vlans: [mgmt, office_b, guest_b]

  Bsw3:
    dp_id: 0x0000000000000007
    hardware: "Open vSwitch"
    interfaces:
      1:
        description: "Bf3h1 office B PC"
        native_vlan: office_b
        acl_in: office_acl
      2:
        description: "Bf3h2 office B PC"
        native_vlan: office_b
        acl_in: office_acl
      3:
        description: "Bf3g1 guest B PC"
        native_vlan: guest_b
        acl_in: guest_b_acl
      4:
        description: "Bsvc3 mgmt B"
        native_vlan: mgmt
        acl_in: mgmt_acl
      6:
        description: "Bf3g2 guest B PC"
        native_vlan: guest_b
        acl_in: guest_b_acl
      24:
        description: "uplink to Bcore"
        tagged_vlans: [mgmt, office_b, guest_b]
